# Расширение раздела файловой системы в Debian-образном Linux в виртуальной машине.

Для расширения одного из разделов необходимо выполнить следующие незамысловатые шаги:

1. Увеличить размер диска в виртуальной машине (VirtualBox, VMWare и других).

2. Сделать snapshot и сохранить таблицу разделовна то случай, если что-то пойдёт не так:

`dd if=/dev/sda .... bs=512 count=1`

3. Удалить все разделы с конца до того раздела, которому требуется расширение.

4. Пересоздать поверх файловые разделы нужного размера с помощью `fdisk`. Ориентироваться на **исходное начальное смещение** (для первичного раздела - 2048) и тип файловой системы 83.
Промах с начальным смещением - потеря данных.

5. Создать раздел для swap-а аналогичным образом. Проще всего до конца диска размером 1Гб (тип файловой системы 82).

6. Актуализировать наполнение fstab с помощью файловой ссылки на основной раздел и комментирование swap-раздела. 
Потом можно будет перейти на типичные нынче UUID.

7. Отключить swap и перезагрузиться

`swapoff`

`reboot`

8. Пересоздать и включить swap: 

`mkswap /dev/sda2`

`swapon -a`

9. Расширить партицию:

`resize2fs /dev/sda1`

12. Переинициализировать initramfs, дабы не было проблем с resum-ом системы:

`sudo update-initramfs -u`